import { exec } from 'child_process';
import { Package } from 'mr-types';
import _ from 'ramda';

export const runInPackage = _.curry(
  (pkg: Package, command: string) =>
    new Promise((res, rej) => {
      exec(command,
        { cwd: pkg.cwd },
        (err, out) => err
          ? rej(err)
          : res(out),
      );
    }),
);

export const runNpmInPackage = _.curry(
  (pkg: Package, command: string) =>
    runInPackage(pkg, `npm run ${command}`),
);

export const runYarnInPackage = _.curry(
  (pkg: Package, command: string) =>
    runInPackage(pkg, `yarn ${command}`),
);
