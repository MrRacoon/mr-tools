import { exec } from 'child_process';
import { Path } from 'mr-types';
import _ from 'ramda';

export const runInPackage = _.curry(
  (cwd: Path, command: string): Promise<[string, string]> =>
    new Promise((res, rej) => {
      exec(
        command,
        { cwd },
        (error, out, err) => error ? rej(error) : res([out, err]),
      );
    }),
);

export const runNpmInPackage = _.curry(
  (cwd: Path, command: string): Promise<[string, string]> =>
    runInPackage(cwd, `npm run ${command}`),
);

export const runYarnInPackage = _.curry(
  (cwd: Path, command: string): Promise<[string, string]> =>
    runInPackage(cwd, `yarn ${command}`),
);
